CREATE DATABASE FINSIGHTCORP;
USE FINSIGHTCORP;
CREATE TABLE YEAR_TBL(
	ID INT PRIMARY KEY,
    YEAR INT,
    NPV INT 
);

CREATE TABLE QUERIES_TBL(
	ID INT,
    YEAR INT
);

INSERT INTO YEAR_TBL
VALUES
(1,2018,100),
(7,2020,30),
(13, 2019, 14),
(1, 2019, 113),
(2, 2008, 121),
(3, 2009, 12),
(11, 2020, 99),
(7, 2019, 0);

INSERT INTO QUERIES_TBL
VALUES
(1,2019),
(2,2008),
(3,2009),
(7,2018),
(7,2019),
(7,2020),
(13,2019);

SELECT Q.ID, Q.YEAR, ISNULL(Y.NPV, 0)
FROM 
	QUERIES_TBL AS Q
LEFT OUTER JOIN
	YEAR_TBL AS Y
ON 
	Q.ID=Y.ID
AND 
	Q.YEAR=Y.YEAR
